(this["webpackJsonppressure-mon"]=this["webpackJsonppressure-mon"]||[]).push([[0],{101:function(t,e,n){},200:function(t,e,n){},201:function(t,e,n){},202:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),i=n(8),s=n.n(i),l=(n(101),n(10)),r=n(14),c=n(30),u=n(31),m=n(32),C=n(15),h=n(48),d=n(84),p=n.n(d),v=new function t(){return Object(l.a)(this,t),t.instance||(t.instance=this),this.MAJOR_BG="rgba(245,0,0,0.8)",this.MAJOR_LINE="rgba(245,0,0,1)",this.OK_BG="rgba(65,190,60,0.9)",this.OK_LINE="rgba(65,190,60,0.6)",this.MINOR_BG="rgba(359, 200, 0, 0.8)",this.MINOR_LINE="rgba(359 ,200, 0, 1)",this.INVALID_BG="rgba(255, 0, 183, 0.8)",this.INVALID_LINE="rgba(255, 0, 183, 1)",this.HOVER_LINE="#FFFFFF",t.this};Object.freeze(v),function(){if("function"===typeof window.CustomEvent)return!1;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}();var O=function t(e){var n=this;Object(l.a)(this,t),e=e||{};var a={url:("https:"===window.location.protocol?"wss:":"ws:")+"//"+window.location.host+"/epics2web/monitor",autoOpen:!0,autoReconnect:!0,autoLivenessPingAndTimeout:!0,autoDisplayClasses:!0,pingIntervalMillis:3e3,livenessTimoutMillis:2e3,reconnectWaitMillis:1e3,chunkedRequestPvsCount:400,clientName:window.location.href};for(var o in a)"undefined"!==typeof e[o]?this[o]=e[o]:this[o]=a[o];this.socket=null,this.eventElem=document.createElement("div"),this.lastUpdated=null,this.livenessTimer=null,this.reconnecting=!1;this.eventElem.addEventListener("open",(function(t){n.onopen(t)})),this.eventElem.addEventListener("close",(function(t){n.onclose(t)})),this.eventElem.addEventListener("connecting",(function(t){n.onconnecting(t)})),this.eventElem.addEventListener("closing",(function(t){n.onclosing(t)})),this.eventElem.addEventListener("error",(function(t){n.onerror(t)})),this.eventElem.addEventListener("message",(function(t){n.onmessage(t)})),this.eventElem.addEventListener("info",(function(t){n.oninfo(t)})),this.eventElem.addEventListener("update",(function(t){n.onupdate(t)})),this.eventElem.addEventListener("pong",(function(t){n.onpong(t)})),this.addEventListener=this.eventElem.addEventListener.bind(this.eventElem),this.removeEventListener=this.eventElem.removeEventListener.bind(this.eventElem),this.dispatchEvent=this.eventElem.dispatchEvent.bind(this.eventElem),this.open=function(){if(null!==n.socket&&n.socket.readyState!==WebSocket.CLOSED)return console.log("already connected"),1;var t=new CustomEvent("connecting");n.eventElem.dispatchEvent(t);var e=n.url;null!==n.clientName&&(e=e+"?clientName="+encodeURIComponent(n.clientName)),n.socket=new WebSocket(e),n.socket.onerror=function(t){console.log("server connection error",t);var e=new CustomEvent("error");n.eventElem.dispatchEvent(e)},n.socket.onclose=function(t){console.log("server connection closed");var e=new CustomEvent("close");n.eventElem.dispatchEvent(e),null!==n.livenessTimer&&(clearTimeout(n.livenessTimer),n.livenessTimer=null);var a=null===n.socket||n.socket.readyState===WebSocket.CLOSED;n.autoReconnect&&!n.reconnecting&&a?(console.log("attempting to reconnect after delay"),n.reconnecting=!0,setTimeout((function(){console.log("reconnect timer triggered"),n.open(),n.reconnecting=!1}),n.reconnectWaitMillis)):console.log("socket is not closed (socket is connecting, closing, or reconnecting / delayed connecting)")},n.socket.onmessage=function(t){null!==n.livenessTimer&&(clearTimeout(n.livenessTimer),n.livenessTimer=null),n.lastUpdated=new Date;var e=JSON.parse(t.data);e.date=n.lastUpdated,"update"===e.type?n.eventElem.dispatchEvent(new CustomEvent("update",{detail:e})):"info"===e.type?n.eventElem.dispatchEvent(new CustomEvent("info",{detail:e})):"pong"===e.type&&n.eventElem.dispatchEvent(new CustomEvent("pong")),n.eventElem.dispatchEvent(new CustomEvent("message"),{detail:e})},n.socket.onopen=function(t){console.log("server connection open"),n.lastUpdated=new Date;var e=new CustomEvent("open");n.eventElem.dispatchEvent(e)}},this.close=function(t,e){console.log("close"),null!==n.socket&&n.socket.readyState!==WebSocket.CLOSED?("undefined"===typeof t&&(t=1e3),n.socket.close(t,e)):console.log("already closed")},this.monitorPvs=function(t){var e,a,o;if(n.chunkedRequestPvsCount>0)for(e=0,a=t.length;e<a;e+=n.chunkedRequestPvsCount)o=t.slice(e,e+n.chunkedRequestPvsCount),n.monitorPvsChunk(o);else n.monitorPvsChunk(t)},this.monitorPvsChunk=function(t){var e={type:"monitor",pvs:t};n.socket.send(JSON.stringify(e))},this.clearPvs=function(t){var e,a,o;if(n.chunkedRequestPvsCount>0)for(e=0,a=t.length;e<a;e+=n.chunkedRequestPvsCount)o=t.slice(e,e+n.chunkedRequestPvsCount),n.clearPvsChunk(o);else n.clearPvsChunk(t)},this.clearPvsChunk=function(t){var e={type:"clear",pvs:t};n.socket.send(JSON.stringify(e))},this.ping=function(){n.socket.send(JSON.stringify({type:"ping"}))},!0===this.autoDisplayClasses&&(this.eventElem.addEventListener("connecting",(function(t){console.log("connecting")})),this.eventElem.addEventListener("open",(function(t){console.log("open")})),this.eventElem.addEventListener("close",(function(t){console.log("close")}))),!0===this.autoOpen&&this.open(),!0===this.autoLivenessPingAndTimeout&&window.setInterval((function(){null!==n.socket&&n.socket.readyState===WebSocket.OPEN&&(n.ping(),null!==n.livenessTimer||(n.livenessTimer=setTimeout((function(){this.socket.readyState===WebSocket.OPEN&&this.socket.close(),this.livenessTimer=null}),n.livenessTimoutMillis)))}),this.pingIntervalMillis)};O.prototype.onopen=function(){},O.prototype.onclose=function(){},O.prototype.onconnecting=function(){},O.prototype.onclosing=function(){},O.prototype.onmessage=function(){},O.prototype.onerror=function(){},O.prototype.onupdate=function(){},O.prototype.oninfo=function(){},O.prototype.onpong=function(){};var M=new function t(){Object(l.a)(this,t),this.createClientConnection=function(t){return new O(t)},t.instance||(t.instance=this,this.epics2web={})};M.epics2web.isNumericEpicsType=function(t){var e;switch(t){case"DBR_DOUBLE":case"DBR_FLOAT":case"DBR_INT":case"DBR_SHORT":case"DBR_BYTE":e=!0;break;default:e=!1}return e};var f=new function t(){return Object(l.a)(this,t),t.instance||(t.instance=this),this.secure="https:"===window.location.protocol,this.epics2webHost="10.0.38.42",this.epics2webLocation="/epics2web",this.epics2webGet=this.secure?"https://":"http://"+this.epics2webHost+this.epics2webLocation+"/caget",this.epics2webWs=this.secure?"wss://":"ws://"+this.epics2webHost+this.epics2webLocation+"/monitor",this.epics2webOptions={url:this.epics2webWs,autoOpen:!0,autoReconnect:!0,autoLivenessPingAndTimeout:!0,autoDisplayClasses:!0,pingIntervalMillis:3e3,livenessTimoutMillis:2e3,reconnectWaitMillis:1e3,chunkedRequestPvsCount:400},t.instance};Object.freeze(f);var S=function t(e){var n=this;Object(l.a)(this,t),this.disconnect=function(){n.con&&(n.con.autoReconnect=!1,n.con.close(),n.monitoredPVsList=[])},this.monitoredPVsList=e,this.con=M.createClientConnection(f.epics2webOptions),this.pvData={},this.monitoredPVsList.forEach((function(t){n.pvData[t]={date:null,value:null,datatype:null,count:null}})),this.con.onopen=function(t){n.con.monitorPvs(n.monitoredPVsList)},this.con.onupdate=function(t){n.pvData[t.detail.pv].date=t.detail.date,n.pvData[t.detail.pv].value=t.detail.value},this.con.oninfo=function(t){n.pvData[t.detail.pv].datatype=t.detail.datatype,n.pvData[t.detail.pv].count=t.detail.count,n.pvData[t.detail.pv].date=t.detail.date,"undefined"!==typeof t.detail["enum-labels"]&&console.log("Enum Labels: "+t.detail["enum-labels"])}},E=n(203),I=n(240),g=n(241),b=n(234),G=n(235),y=n(238),k=n(236),w=n(86),L=n.n(w),V=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).handleClickOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.handleAlarmState=function(t,e){n.setState((function(n,a){null==t&&(t=n.highVal),null==e&&(e=n.hihiVal);var o=parseFloat(t)>=parseFloat(e);return{hihiVal:e,highVal:t,hihiError:isNaN(e)||""===e||o,highError:isNaN(t)||""===t||o}}))},n.state={handleConfig:null,open:!1,hihiError:!1,highError:!1,hihiVal:t.hihi,highVal:t.high},n}return Object(m.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){var t=this;return o.a.createElement("div",null,o.a.createElement(E.a,{startIcon:o.a.createElement(L.a,null),size:"small",style:{margin:"2px"},variant:"contained",color:"primary",onClick:this.handleClickOpen}," Settings"),o.a.createElement(I.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(g.a,{id:"alert-dialog-title"},this.props.title),o.a.createElement(b.a,{component:"span"},o.a.createElement(G.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},o.a.createElement(y.a,{style:{padding:"5px"},error:this.state.hihiError,label:"Major alarm (HIHI)",defaultValue:this.props.hihi,value:this.state.hihiVal,onChange:function(e){return t.handleAlarmState(null,e.target.value)}}),o.a.createElement(y.a,{style:{padding:"5px"},error:this.state.highError,label:"Minor alarm (HIGH)",defaultValue:this.props.high,value:this.state.highVal,onChange:function(e){return t.handleAlarmState(e.target.value,null)}}))),o.a.createElement(k.a,null,o.a.createElement(E.a,{onClick:function(){t.state.highError||t.state.hihiError||(t.props.handleConfig(t.state.hihiVal?t.state.hihiVal:t.props.hihi,t.state.highVal?t.state.highVal:t.props.high),t.handleClose())},variant:"contained",color:"primary"},"OK"),o.a.createElement(E.a,{onClick:function(){t.handleClose()},variant:"contained",color:"secondary"},"Close"))))}}]),e}(o.a.Component);n(200);h.b.global.defaultFontColor="#FFF",h.b.global.defaultFontSize=16;var N=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).updatePVValues=function(){var t=n.state,e=t.minorVal,a=t.majorVal,o=n.props.pvs;n.values=o.map((function(t){return n.epics.pvData[t].value})),n.valuesMax=Math.max.apply(Math,Object(C.a)(n.values)),n.alarms.bg=n.values.map((function(t){return t&&!isNaN(t)?t<e?v.OK_BG:t>=e&&t<a?v.MINOR_BG:v.MAJOR_BG:v.OK_BG})),n.alarms.border=n.values.map((function(t){return!t||isNaN(t)?v.OK_LINE:t<e?v.OK_LINE:t>=e&&t<a?v.MINOR_LINE:void 0}))},n.updateContent=function(){n.updatePVValues(),n.setState((function(t,e){t.minorVal;var a=t.majorVal,o=t.minorArray,i=t.majorArray,s=e.pvs,l=n.valuesMax>a?n.valuesMax:a;return{chartData:{labels:s,datasets:[{label:"MKS - Cold Cathode",backgroundColor:n.alarms.bg,borderColor:n.alarms.border,borderWidth:1,hoverBackgroundColor:v.OK_BG,hoverBorderColor:v.HOVER_LINE,data:n.values},{label:"Minor Alarm",type:"line",fill:!1,backgroundColor:v.MINOR_BG,borderColor:v.MINOR_LINE,borderWidth:1,data:o,pointRadius:0,datalabels:{display:!1}},{label:"Major Alarm",type:"line",fill:!1,backgroundColor:v.MAJOR_BG,borderColor:v.MAJOR_LINE,borderWidth:1,data:i,pointRadius:0,datalabels:{display:!1}}]},maxVal:l}}))},n.handleConfig=function(t,e){e=parseFloat(e),((t=parseFloat(t))!=n.state.majorVal||e!=n.state.minorVal)&&e<t&&n.setState((function(n,a){var o=a.pvs;return{minorVal:e,majorVal:t,minorArray:o.map((function(){return e})),majorArray:o.map((function(){return t}))}}))},n.state={tooltipText:"",tooltipVisible:!1,minorVal:t.high?t.high:2e3,minorArray:t.pvs.map((function(){return t.high?t.high:1e-8})),majorVal:t.hihi?t.hihi:200,majorArray:t.pvs.map((function(){return t.hihi?t.hihi:1e-7})),maxVal:null},n.timer=null,n.refreshInterval=100,n.epics=new S(n.props.pvs),n.values=[],n.alarms={bg:[],border:[]},n.max=n.state.majorVal,n}return Object(m.a)(e,t),Object(r.a)(e,[{key:"componentDidUpdate",value:function(t,e,n){}},{key:"componentDidMount",value:function(){this.timer=setInterval(this.updateContent,this.refreshInterval)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.epics.disconnect()}},{key:"renderBar",value:function(){var t=this.state,e=(t.majorVal,t.minorVal,t.maxVal),n=this.props.customTooltipCallback;return o.a.createElement(h.a,{data:this.state.chartData,plugins:[p.a],options:{plugins:{datalabels:{rotation:270,font:{weight:"bold"},formatter:function(t,e){return t.toExponential()}}},tooltips:{mode:"index",enabled:!1,custom:n},maintainAspectRatio:!1,responsive:!0,legend:{position:"bottom",align:"center",display:!1,labels:{}},scales:{xAxes:[{ticks:{},gridLines:{display:!0,color:"rgba(184,184,184,0.2)",zeroLineColor:"rgba(184,184,184,0.8)"}}],yAxes:[{id:"pulse",scaleLabel:{display:!0,labelString:"Pulse/s"},gridLines:{display:!0,color:"rgba(184,184,184,0.2)",zeroLineColor:"rgba(184,184,184,0.8)"},ticks:{min:1e-12,max:e,fontSize:14},display:!0,type:"logarithmic"}]}}})}},{key:"render",value:function(){var t=this.state,e=t.minorVal,n=t.majorVal,a=this.props,i=a.title;a.backHandler;return o.a.createElement("div",{className:"GammaBar"},o.a.createElement("div",{className:"Title"},i),o.a.createElement(V,{title:i+" settings",high:e,hihi:n,handleConfig:this.handleConfig}),this.state.chartData?o.a.createElement("article",{className:"GraphContainer"}," ",this.renderBar()," "):"loading...")}}]),e}(o.a.Component);N.defaultProps={title:"A graph"};var j=N,R=n(237),T=n(89),P={hihi:2e3,high:200},D=(n(201),0),A=3,_=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).customTooltipCallback=function(t){if(0!==t.opacity){var e=t.dataPoints[0].xLabel,a=t.dataPoints[0].yLabel;n.setState({tooltipVisible:!0,tooltipX:e,tooltipY:a})}else n.setState({tooltipVisible:!1,tooltipX:"",tooltipY:""})},n.renderNav=function(){return n.state.content!==D?o.a.createElement("div",{className:"Menu"},o.a.createElement(E.a,{variant:"contained",color:"default",onClick:function(){return n.setState({content:D})}},"Back")):o.a.createElement("div",{className:"Menu"},o.a.createElement("div",{className:"MainTitle"},n.state.title),o.a.createElement("div",{style:{"margin-bottom":"15px"},className:"SubTitle"}),o.a.createElement(R.a,{orientation:"vertical",color:"primary"},o.a.createElement(E.a,{variant:"contained",color:"primary",onClick:function(){return n.setState({content:A})}},"Gamma"),o.a.createElement("br",null)))},n.renderCustomTooltip=function(){return o.a.createElement("table",{align:"center"},o.a.createElement("tbody",null,n.state.tooltipVisible?o.a.createElement("tr",null,o.a.createElement("td",null,n.state.tooltipX),o.a.createElement("td",null,n.state.tooltipY)):o.a.createElement("tr",null,o.a.createElement("td",null,"\xa0"),o.a.createElement("td",null,"\xa0"))))},n.backHandler=function(){return n.setState({content:D})},n.renderGraph=function(){switch(n.state.content){case A:return o.a.createElement(j,Object.assign({customTooltipCallback:n.customTooltipCallback,pvs:T,title:"GAMMA"},P));default:return n.state.tooltipVisible&&n.setState({tooltipVisible:!1}),o.a.createElement("div",null)}},n.state={content:D,tooltipVisible:!1,tooltipX:"",tooltipY:"",title:"Sirius - Gamma Detectors"},n}return Object(m.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},this.renderGraph(),this.renderCustomTooltip(),this.renderNav())}}]),e}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},89:function(t){t.exports=JSON.parse('["SI-01M2:CO-Gamma:Count-Mon","SI-01C1:CO-Gamma:Count-Mon","SI-01C2:CO-Gamma:Count-Mon","SI-01C3:CO-Gamma:Count-Mon","SI-01C4:CO-Gamma:Count-Mon","SI-02M2:CO-Gamma:Count-Mon","SI-02C1:CO-Gamma:Count-Mon","SI-02C2:CO-Gamma:Count-Mon","SI-02C3:CO-Gamma:Count-Mon","SI-02C4:CO-Gamma:Count-Mon","SI-03M2:CO-Gamma:Count-Mon","SI-03C1:CO-Gamma:Count-Mon","SI-03C2:CO-Gamma:Count-Mon","SI-03C3:CO-Gamma:Count-Mon","SI-03C4:CO-Gamma:Count-Mon","SI-04M2:CO-Gamma:Count-Mon","SI-04C1:CO-Gamma:Count-Mon","SI-04C2:CO-Gamma:Count-Mon","SI-04C3:CO-Gamma:Count-Mon","SI-04C4:CO-Gamma:Count-Mon","SI-05M2:CO-Gamma:Count-Mon","SI-05C1:CO-Gamma:Count-Mon","SI-05C2:CO-Gamma:Count-Mon","SI-05C3:CO-Gamma:Count-Mon","SI-05C4:CO-Gamma:Count-Mon","SI-06M2:CO-Gamma:Count-Mon","SI-06C1:CO-Gamma:Count-Mon","SI-06C2:CO-Gamma:Count-Mon","SI-06C3:CO-Gamma:Count-Mon","SI-06C4:CO-Gamma:Count-Mon","SI-07M2:CO-Gamma:Count-Mon","SI-07C1:CO-Gamma:Count-Mon","SI-07C2:CO-Gamma:Count-Mon","SI-07C3:CO-Gamma:Count-Mon","SI-07C4:CO-Gamma:Count-Mon","SI-08M2:CO-Gamma:Count-Mon","SI-08C1:CO-Gamma:Count-Mon","SI-08C2:CO-Gamma:Count-Mon","SI-08C3:CO-Gamma:Count-Mon","SI-08C4:CO-Gamma:Count-Mon","SI-09M2:CO-Gamma:Count-Mon","SI-09C1:CO-Gamma:Count-Mon","SI-09C2:CO-Gamma:Count-Mon","SI-09C3:CO-Gamma:Count-Mon","SI-09C4:CO-Gamma:Count-Mon","SI-10M2:CO-Gamma:Count-Mon","SI-10C1:CO-Gamma:Count-Mon","SI-10C2:CO-Gamma:Count-Mon","SI-10C3:CO-Gamma:Count-Mon","SI-10C4:CO-Gamma:Count-Mon","SI-11M2:CO-Gamma:Count-Mon","SI-11C1:CO-Gamma:Count-Mon","SI-11C2:CO-Gamma:Count-Mon","SI-11C3:CO-Gamma:Count-Mon","SI-11C4:CO-Gamma:Count-Mon","SI-12M2:CO-Gamma:Count-Mon","SI-12C1:CO-Gamma:Count-Mon","SI-12C2:CO-Gamma:Count-Mon","SI-12C3:CO-Gamma:Count-Mon","SI-12C4:CO-Gamma:Count-Mon","SI-13M2:CO-Gamma:Count-Mon","SI-13C1:CO-Gamma:Count-Mon","SI-13C2:CO-Gamma:Count-Mon","SI-13C3:CO-Gamma:Count-Mon","SI-13C4:CO-Gamma:Count-Mon","SI-14M2:CO-Gamma:Count-Mon","SI-14C1:CO-Gamma:Count-Mon","SI-14C2:CO-Gamma:Count-Mon","SI-14C3:CO-Gamma:Count-Mon","SI-14C4:CO-Gamma:Count-Mon","SI-15M2:CO-Gamma:Count-Mon","SI-15C1:CO-Gamma:Count-Mon","SI-15C2:CO-Gamma:Count-Mon","SI-15C3:CO-Gamma:Count-Mon","SI-15C4:CO-Gamma:Count-Mon","SI-16M2:CO-Gamma:Count-Mon","SI-16C1:CO-Gamma:Count-Mon","SI-16C2:CO-Gamma:Count-Mon","SI-16C3:CO-Gamma:Count-Mon","SI-16C4:CO-Gamma:Count-Mon","SI-17M2:CO-Gamma:Count-Mon","SI-17C1:CO-Gamma:Count-Mon","SI-17C2:CO-Gamma:Count-Mon","SI-17C3:CO-Gamma:Count-Mon","SI-17C4:CO-Gamma:Count-Mon","SI-18M2:CO-Gamma:Count-Mon","SI-18C1:CO-Gamma:Count-Mon","SI-18C2:CO-Gamma:Count-Mon","SI-18C3:CO-Gamma:Count-Mon","SI-18C4:CO-Gamma:Count-Mon","SI-19M2:CO-Gamma:Count-Mon","SI-19C1:CO-Gamma:Count-Mon","SI-19C2:CO-Gamma:Count-Mon","SI-19C3:CO-Gamma:Count-Mon","SI-19C4:CO-Gamma:Count-Mon","SI-20M2:CO-Gamma:Count-Mon","SI-20C1:CO-Gamma:Count-Mon","SI-20C2:CO-Gamma:Count-Mon","SI-20C3:CO-Gamma:Count-Mon","SI-20C4:CO-Gamma:Count-Mon"]')},96:function(t,e,n){t.exports=n(202)}},[[96,1,2]]]);
//# sourceMappingURL=main.28b75013.chunk.js.map